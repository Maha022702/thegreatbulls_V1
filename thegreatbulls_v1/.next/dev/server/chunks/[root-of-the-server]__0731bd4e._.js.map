{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/aj/Documents/Projects/thegreatbulls-react/thegreatbulls_v1/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined\n}\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient()\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6QAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 65, "column": 0}, "map": {"version":3,"sources":["file:///home/aj/Documents/Projects/thegreatbulls-react/thegreatbulls_v1/src/app/api/courses/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { prisma } from '@/lib/prisma'\nimport bcrypt from 'bcryptjs'\n\nexport async function GET(req: NextRequest) {\n  try {\n    const courses = await prisma.course.findMany({\n      include: {\n        instructor: {\n          select: {\n            id: true,\n            name: true,\n            email: true,\n            bio: true\n          }\n        },\n        category: {\n          select: {\n            id: true,\n            name: true\n          }\n        }\n      },\n      orderBy: {\n        createdAt: 'desc'\n      }\n    })\n\n    return NextResponse.json(courses)\n  } catch (error) {\n    console.error('Error fetching courses:', error)\n    return NextResponse.json({ error: 'Internal server error', details: String(error) }, { status: 500 })\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    console.log('POST /api/courses - Starting course creation')\n\n    const body = await request.json()\n    console.log('Request body received:', { \n      title: body.title, \n      category: body.category,\n      price: body.price,\n      instructorName: body.instructorName \n    })\n\n    const {\n      title,\n      subtitle = '',\n      description,\n      shortDescription = '',\n      price,\n      category,\n      level = 'BEGINNER',\n      instructorName,\n      instructorBio = '',\n      thumbnail = '',\n      duration = 0,\n      language = 'English',\n      prerequisites = [],\n      requirements = [],\n      learningObjectives = [],\n      whatYouWillLearn = [],\n      learningOutcomes = null,\n      courseOverview = '',\n      courseTopics = [],\n      skillsCovered = [],\n      targetAudience = [],\n      tags = [],\n      status = 'DRAFT',\n      isPublished = false,\n      isFeatured = false,\n      expiryDate = null,\n      maxEnrollments = null,\n      certificateTemplate = ''\n    } = body\n\n    // Validate required fields\n    if (!title?.trim() || !description?.trim() || !price || !category?.trim() || !level?.trim()) {\n      console.log('Validation failed - missing required fields')\n      return NextResponse.json({ \n        error: 'Missing required fields',\n        required: ['title', 'description', 'price', 'category', 'level']\n      }, { status: 400 })\n    }\n\n    if (!instructorName?.trim()) {\n      return NextResponse.json({ error: 'Instructor name is required' }, { status: 400 })\n    }\n\n    console.log('Validation passed, creating resources...')\n\n    // Create or find category\n    let categoryId: string | null = null\n    try {\n      const categoryRecord = await prisma.category.upsert({\n        where: { name: category.trim() },\n        update: {},\n        create: {\n          name: category.trim(),\n          slug: category.trim().toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-|-$/g, '')\n        }\n      })\n      categoryId = categoryRecord.id\n      console.log('Category ready:', categoryId)\n    } catch (categoryError) {\n      console.error('Category creation error:', categoryError)\n      categoryId = null\n    }\n\n    // Create unique slug for course\n    const courseSlug = title\n      .toLowerCase()\n      .replace(/[^a-z0-9]+/g, '-')\n      .replace(/^-|-$/g, '')\n      + '-' + Date.now().toString().slice(-6)\n\n    // Create or find instructor\n    const instructorEmail = `${instructorName.trim().toLowerCase().replace(/\\s+/g, '.')}@instructor.local`\n    let instructorId: string\n\n    try {\n      const instructor = await prisma.user.upsert({\n        where: { email: instructorEmail },\n        update: {\n          name: instructorName.trim()\n        },\n        create: {\n          email: instructorEmail,\n          name: instructorName.trim(),\n          password: await bcrypt.hash('password123', 10),\n          role: 'INSTRUCTOR'\n        }\n      })\n      instructorId = instructor.id\n      console.log('Instructor ready:', instructorId)\n    } catch (instructorError) {\n      console.error('Instructor creation error:', instructorError)\n      throw new Error(`Failed to create instructor: ${instructorError instanceof Error ? instructorError.message : 'Unknown error'}`)\n    }\n\n    // Create the course\n    console.log('Creating course with slug:', courseSlug)\n    const course = await prisma.course.create({\n      data: {\n        title: title.trim(),\n        slug: courseSlug,\n        subtitle: subtitle.trim(),\n        description: description.trim(),\n        shortDescription: shortDescription.trim(),\n        price: parseFloat(price.toString()),\n        categoryId,\n        level: level.toUpperCase() as any,\n        instructorId,\n        thumbnail,\n        duration: parseInt(duration.toString()) || 0,\n        language,\n        overview: courseOverview.trim() || null,\n        courseTopics: (courseTopics || []).filter((t: string) => t.trim()),\n        skillsCovered: (skillsCovered || []).filter((s: string) => s.trim()),\n        prerequisites: (prerequisites || []).filter((p: string) => p.trim()),\n        requirements: (requirements || []).filter((r: string) => r.trim()),\n        whatYouWillLearn: (whatYouWillLearn || learningObjectives || []).filter((l: string) => l.trim()),\n        learningOutcomes: learningOutcomes,\n        targetAudience: (targetAudience || []).filter((a: string) => a.trim()),\n        keywords: (tags || []).filter((t: string) => t.trim()),\n        status: status.toUpperCase() as any,\n        isPublished: Boolean(isPublished),\n        isFeatured: Boolean(isFeatured),\n        expiryDate: expiryDate ? new Date(expiryDate) : null,\n        maxEnrollments: maxEnrollments ? parseInt(maxEnrollments.toString()) : null,\n        certificateTemplate: certificateTemplate?.trim() || null\n      }\n    })\n\n    console.log('Course created successfully:', course.id)\n    return NextResponse.json(course, { status: 201 })\n\n  } catch (error) {\n    console.error('Error creating course:', error)\n    const errorMessage = error instanceof Error ? error.message : 'Unknown error'\n    return NextResponse.json({ \n      error: 'Failed to create course',\n      message: errorMessage \n    }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}